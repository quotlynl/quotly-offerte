<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quotly ‚Äî Schilder Offerte Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --navy: #1a3a5c;
    --blue: #2563eb;
    --blue-light: #3b82f6;
    --bg: #020b18;
    --bg2: #0d1a2a;
    --bg3: #111f30;
    --border: rgba(255,255,255,0.07);
    --border2: rgba(255,255,255,0.12);
    --text: #e2eaf4;
    --muted: #5a7a9a;
    --muted2: #8aacc8;
  }
  html { scroll-behavior: smooth; }
  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    background-image: radial-gradient(ellipse at 20% 0%, rgba(37,99,235,0.08) 0%, transparent 60%),
                      radial-gradient(ellipse at 80% 100%, rgba(26,58,92,0.15) 0%, transparent 60%);
  }
  .serif { font-family: 'Playfair Display', serif; }

  /* HEADER */
  header {
    position: sticky; top: 0; z-index: 100;
    background: rgba(2,11,24,0.85);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 0 32px;
  }
  .header-inner {
    max-width: 1100px; margin: 0 auto;
    display: flex; align-items: center; justify-content: space-between;
    height: 60px;
  }
  .brand { display: flex; align-items: baseline; gap: 10px; }
  .brand-name { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 700; color: #fff; letter-spacing: -0.5px; }
  .brand-name span { color: #60a5fa; }
  .brand-tag { font-size: 10px; color: var(--muted); text-transform: uppercase; letter-spacing: 2.5px; }
  .tab-group { display: flex; gap: 4px; background: var(--bg3); border-radius: 10px; padding: 4px; }
  .tab-btn {
    padding: 6px 18px; border-radius: 7px; border: none; cursor: pointer;
    font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500;
    transition: all 0.2s;
    background: transparent; color: var(--muted);
  }
  .tab-btn.active { background: var(--blue); color: #fff; box-shadow: 0 4px 16px rgba(37,99,235,0.35); }
  .tab-btn:not(.active):hover { color: var(--text); }
  .tab-btn:disabled { opacity: 0.3; cursor: not-allowed; }

  /* LAYOUT */
  .main { max-width: 1100px; margin: 0 auto; padding: 36px 32px; }
  .grid { display: grid; grid-template-columns: 1fr 340px; gap: 24px; }

  /* CARDS */
  .card {
    background: linear-gradient(135deg, var(--bg2) 0%, rgba(13,26,42,0.8) 100%);
    border: 1px solid var(--border);
    border-radius: 20px; padding: 28px;
    margin-bottom: 16px;
    transition: border-color 0.2s;
  }
  .card:hover { border-color: var(--border2); }
  .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 24px; }
  .step-badge {
    width: 32px; height: 32px; border-radius: 10px;
    background: rgba(37,99,235,0.15);
    border: 1px solid rgba(37,99,235,0.3);
    color: #60a5fa; font-size: 13px; font-weight: 700;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
  }
  .card-title { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 3px; color: var(--muted2); }

  /* FORM ELEMENTS */
  .field { margin-bottom: 16px; }
  .field:last-child { margin-bottom: 0; }
  label { display: block; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 2.5px; color: var(--muted); margin-bottom: 8px; }
  input[type="text"], input[type="email"], input[type="number"] {
    width: 100%; background: rgba(255,255,255,0.03); border: 1px solid var(--border2);
    border-radius: 12px; padding: 12px 16px; color: var(--text); font-family: 'DM Sans', sans-serif;
    font-size: 14px; transition: all 0.2s; outline: none;
  }
  input::placeholder { color: var(--muted); }
  input:focus { border-color: rgba(37,99,235,0.6); background: rgba(37,99,235,0.05); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }

  .opt-group { display: flex; gap: 8px; flex-wrap: wrap; }
  .opt-btn {
    flex: 1; min-width: 80px; padding: 10px 12px; border-radius: 10px;
    border: 1px solid var(--border2); background: rgba(255,255,255,0.02);
    color: var(--muted2); font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500;
    cursor: pointer; transition: all 0.2s; text-align: center; white-space: nowrap;
  }
  .opt-btn:hover { border-color: rgba(37,99,235,0.4); color: var(--text); background: rgba(37,99,235,0.05); }
  .opt-btn.selected {
    background: rgba(37,99,235,0.2); border-color: rgba(37,99,235,0.6);
    color: #fff; box-shadow: 0 4px 16px rgba(37,99,235,0.2);
  }
  .opt-badge { font-size: 10px; opacity: 0.7; margin-left: 2px; }
  .hint { font-size: 11px; color: var(--muted); margin-top: 6px; }

  /* SIDEBAR */
  .sidebar { position: sticky; top: 80px; height: fit-content; }
  .calc-card {
    background: linear-gradient(135deg, var(--bg2), rgba(13,26,42,0.9));
    border: 1px solid var(--border); border-radius: 20px; padding: 28px;
    margin-bottom: 16px;
  }
  .calc-label { font-size: 10px; text-transform: uppercase; letter-spacing: 3px; color: var(--muted); margin-bottom: 20px; }
  .empty-state { text-align: center; padding: 32px 0; }
  .empty-icon { font-size: 36px; margin-bottom: 12px; }
  .empty-text { color: var(--muted); font-size: 13px; }
  .calc-row {
    display: flex; justify-content: space-between; align-items: flex-start;
    padding: 13px 0; border-bottom: 1px solid var(--border);
  }
  .calc-row:last-of-type { border-bottom: none; }
  .calc-row-label { font-size: 13px; color: var(--text); }
  .calc-row-sub { font-size: 11px; color: var(--muted); margin-top: 2px; }
  .calc-row-val { font-size: 13px; font-weight: 500; color: var(--muted2); }
  .total-box {
    margin-top: 16px; padding: 18px 20px; border-radius: 14px;
    background: linear-gradient(135deg, var(--navy), #0f2a45);
    border: 1px solid rgba(37,99,235,0.3);
    display: flex; justify-content: space-between; align-items: center;
  }
  .total-label { font-size: 13px; font-weight: 600; color: rgba(255,255,255,0.8); }
  .total-val { font-size: 22px; font-weight: 700; color: #60a5fa; font-family: 'Playfair Display', serif; }
  .btw-note { font-size: 11px; color: var(--muted); margin-top: 8px; text-align: right; }

  .btn-primary {
    width: 100%; padding: 16px; border-radius: 14px; border: none;
    background: linear-gradient(135deg, #2563eb, #1d4ed8);
    color: #fff; font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; letter-spacing: 0.3px;
    box-shadow: 0 8px 24px rgba(37,99,235,0.35);
  }
  .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 12px 32px rgba(37,99,235,0.45); background: linear-gradient(135deg, #3b82f6, #2563eb); }
  .btn-primary:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }

  /* PREVIEW */
  #preview-section { display: none; }
  .preview-topbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px; }
  .back-btn {
    background: none; border: 1px solid var(--border2); color: var(--muted2);
    padding: 8px 18px; border-radius: 10px; cursor: pointer; font-family: 'DM Sans', sans-serif;
    font-size: 13px; transition: all 0.2s;
  }
  .back-btn:hover { border-color: var(--border2); color: var(--text); background: rgba(255,255,255,0.03); }
  .pdf-btn {
    background: linear-gradient(135deg, #2563eb, #1d4ed8);
    border: none; color: #fff; padding: 10px 24px; border-radius: 10px;
    cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 13px; font-weight: 600;
    display: flex; align-items: center; gap: 8px; transition: all 0.2s;
    box-shadow: 0 6px 20px rgba(37,99,235,0.35);
  }
  .pdf-btn:hover { transform: translateY(-1px); box-shadow: 0 10px 28px rgba(37,99,235,0.45); }

  /* OFFERTE DOCUMENT */
  .offerte-doc {
    background: #fff; color: #1a2332;
    border-radius: 20px; padding: 60px 56px; max-width: 820px; margin: 0 auto;
    box-shadow: 0 32px 80px rgba(0,0,0,0.5);
    font-family: 'DM Sans', sans-serif;
  }
  .doc-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 48px; padding-bottom: 28px; border-bottom: 3px solid #1a3a5c; }
  .doc-brand-name { font-family: 'Playfair Display', serif; font-size: 30px; font-weight: 700; color: #1a3a5c; letter-spacing: -0.5px; }
  .doc-brand-name span { color: #2563eb; }
  .doc-brand-sub { font-size: 11px; color: #9aaebd; margin-top: 6px; text-transform: uppercase; letter-spacing: 2.5px; }
  .doc-meta { text-align: right; font-size: 13px; color: #5a6e82; line-height: 2; }
  .doc-meta strong { color: #1a3a5c; }
  .doc-two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 36px; }
  .doc-section-label { font-size: 10px; text-transform: uppercase; letter-spacing: 3px; color: #9aaebd; margin-bottom: 14px; }
  .doc-info { font-size: 14px; line-height: 2; color: #3a4e62; }
  .doc-info strong { color: #1a2332; display: block; }
  .scope-box { background: #f4f7fb; border-left: 4px solid #1a3a5c; padding: 20px 24px; border-radius: 0 10px 10px 0; margin-bottom: 36px; }
  .scope-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
  .scope-item-label { font-size: 10px; color: #9aaebd; text-transform: uppercase; letter-spacing: 1.5px; }
  .scope-item-val { font-size: 15px; font-weight: 600; color: #1a2332; margin-top: 4px; }
  .doc-table { width: 100%; border-collapse: collapse; margin-bottom: 0; }
  .doc-table th { font-size: 10px; text-transform: uppercase; letter-spacing: 2px; color: #9aaebd; padding: 10px 14px; border-bottom: 1px solid #dde5ef; text-align: left; }
  .doc-table th:last-child { text-align: right; }
  .doc-table td { font-size: 14px; color: #3a4e62; padding: 14px; border-bottom: 1px solid #f0f3f8; }
  .doc-table td:first-child { font-weight: 600; color: #1a2332; }
  .doc-table td:last-child { text-align: right; font-weight: 500; }
  .doc-totals { border-top: 2px solid #1a3a5c; margin-top: 4px; }
  .doc-subtotal-row { display: flex; justify-content: space-between; padding: 10px 14px; font-size: 13px; color: #7a8fa6; }
  .doc-btw-row { display: flex; justify-content: space-between; padding: 6px 14px 14px; font-size: 13px; color: #7a8fa6; border-bottom: 1px solid #dde5ef; }
  .doc-total-row { display: flex; justify-content: space-between; align-items: center; background: #1a3a5c; color: #fff; border-radius: 12px; margin-top: 14px; padding: 18px 22px; }
  .doc-total-label { font-size: 15px; font-weight: 600; }
  .doc-total-val { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 700; color: #60a5fa; }
  .doc-voorwaarden { margin-top: 40px; padding: 20px 24px; background: #f9fafb; border-radius: 12px; }
  .doc-vw-title { font-size: 13px; font-weight: 600; color: #3a4e62; margin-bottom: 10px; }
  .doc-vw-list { list-style: none; }
  .doc-vw-list li { font-size: 12px; color: #7a8fa6; line-height: 2.2; padding-left: 14px; position: relative; }
  .doc-vw-list li::before { content: "¬∑"; position: absolute; left: 0; color: #1a3a5c; font-weight: 700; }
  .doc-footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e8eef5; text-align: center; font-size: 12px; color: #b0bec9; line-height: 2; }

  @media print {
    body { background: #fff !important; }
    header, .preview-topbar, #form-section { display: none !important; }
    #preview-section { display: block !important; }
    .offerte-doc { box-shadow: none; padding: 40px; }
  }
  @media (max-width: 768px) {
    .grid { grid-template-columns: 1fr; }
    .sidebar { position: static; }
    .main { padding: 20px 16px; }
    .offerte-doc { padding: 32px 24px; }
    .doc-two-col { grid-template-columns: 1fr; gap: 24px; }
    .scope-grid { grid-template-columns: 1fr 1fr; }
  }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="brand">
      <div class="brand-name">Quot<span>ly</span></div>
      <div class="brand-tag">Offerte Generator ¬∑ Tiel</div>
    </div>
    <div class="tab-group">
      <button class="tab-btn active" id="tab-form" onclick="showSection('form')">Formulier</button>
      <button class="tab-btn" id="tab-preview" onclick="showSection('preview')" disabled>Offerte Bekijken</button>
    </div>
  </div>
</header>

<!-- FORM -->
<div class="main" id="form-section">
  <div class="grid">
    <div>

      <!-- Stap 1 -->
      <div class="card">
        <div class="card-header">
          <div class="step-badge">1</div>
          <div class="card-title">Klantgegevens</div>
        </div>
        <div class="field">
          <label>Naam</label>
          <input type="text" id="naam" placeholder="J. de Vries" oninput="updateCalc()"/>
        </div>
        <div class="field">
          <label>Adres</label>
          <input type="text" id="adres" placeholder="Hoofdstraat 12, 1234 AB Amsterdam" oninput="updateCalc()"/>
        </div>
        <div class="field">
          <label>E-mailadres</label>
          <input type="email" id="email" placeholder="naam@email.nl" oninput="updateCalc()"/>
        </div>
      </div>

      <!-- Stap 2 -->
      <div class="card">
        <div class="card-header">
          <div class="step-badge">2</div>
          <div class="card-title">Type Werk</div>
        </div>
        <div class="field">
          <label>Kies het type werk</label>
          <div class="opt-group" id="typeWerk-group">
            <button class="opt-btn selected" data-group="typeWerk" data-val="sauswerk" onclick="selectOpt(this)">Sauswerk</button>
            <button class="opt-btn" data-group="typeWerk" data-val="lakwerk" onclick="selectOpt(this)">Lakwerk</button>
            <button class="opt-btn" data-group="typeWerk" data-val="behangen" onclick="selectOpt(this)">Behangen</button>
            <button class="opt-btn" data-group="typeWerk" data-val="buitenwerk" onclick="selectOpt(this)">Buitenschilderwerk</button>
          </div>
        </div>
        <div class="field">
          <label>Oppervlakte (m¬≤)</label>
          <input type="number" id="oppervlakte" placeholder="bijv. 80" min="1" oninput="updateCalc()"/>
          <div class="hint" id="uren-hint">Vul oppervlakte in voor een schatting van de uitvoeringstijd</div>
        </div>
      </div>

      <!-- Stap 3 -->
      <div class="card">
        <div class="card-header">
          <div class="step-badge">3</div>
          <div class="card-title">Specificaties</div>
        </div>
        <div class="field">
          <label>Staat van de ondergrond</label>
          <div class="opt-group">
            <button class="opt-btn selected" data-group="ondergrond" data-val="goed" onclick="selectOpt(this)">Goed</button>
            <button class="opt-btn" data-group="ondergrond" data-val="matig" onclick="selectOpt(this)">Matig <span class="opt-badge">+10%</span></button>
            <button class="opt-btn" data-group="ondergrond" data-val="slecht" onclick="selectOpt(this)">Slecht <span class="opt-badge">+25%</span></button>
          </div>
        </div>
        <div class="field" style="margin-top:20px;">
          <label>Verfsoort</label>
          <div class="opt-group">
            <button class="opt-btn selected" data-group="verfsoort" data-val="standaard" onclick="selectOpt(this)">Standaard</button>
            <button class="opt-btn" data-group="verfsoort" data-val="premium" onclick="selectOpt(this)">Premium <span class="opt-badge">+15%</span></button>
            <button class="opt-btn" data-group="verfsoort" data-val="ecologisch" onclick="selectOpt(this)">Ecologisch <span class="opt-badge">+20%</span></button>
          </div>
        </div>
      </div>

    </div>

    <!-- SIDEBAR -->
    <div class="sidebar">
      <div class="calc-card">
        <div class="calc-label">Live Berekening</div>
        <div id="calc-empty" class="empty-state">
          <div class="empty-icon">üñåÔ∏è</div>
          <div class="empty-text">Vul een oppervlakte in<br/>om de prijs te berekenen</div>
        </div>
        <div id="calc-rows" style="display:none;">
          <div class="calc-row">
            <div><div class="calc-row-label">Arbeidskosten</div><div class="calc-row-sub" id="uren-label">‚Äî</div></div>
            <div class="calc-row-val" id="val-arbeid">‚Äî</div>
          </div>
          <div class="calc-row">
            <div><div class="calc-row-label">Materiaalkosten</div><div class="calc-row-sub" id="mat-label">‚Äî</div></div>
            <div class="calc-row-val" id="val-materiaal">‚Äî</div>
          </div>
          <div class="calc-row" id="toeslag-row" style="display:none;">
            <div><div class="calc-row-label">Toeslagen</div><div class="calc-row-sub" id="toeslag-label">‚Äî</div></div>
            <div class="calc-row-val" id="val-toeslag">‚Äî</div>
          </div>
          <div class="calc-row">
            <div><div class="calc-row-label" style="color:var(--muted);">BTW (21%)</div></div>
            <div class="calc-row-val" id="val-btw" style="color:var(--muted);">‚Äî</div>
          </div>
          <div class="total-box">
            <div class="total-label">Totaal incl. BTW</div>
            <div class="total-val" id="val-totaal">‚Äî</div>
          </div>
          <div class="btw-note" id="subtotaal-note"></div>
        </div>
      </div>
      <button class="btn-primary" id="offerte-btn" onclick="showSection('preview')" disabled>
        Offerte Opmaken ‚Üí
      </button>
    </div>
  </div>
</div>

<!-- PREVIEW -->
<div class="main" id="preview-section" style="display:none;">
  <div class="preview-topbar">
    <button class="back-btn" onclick="showSection('form')">‚Üê Terug naar formulier</button>
    <button class="pdf-btn" onclick="window.print()">
      <svg width="15" height="15" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
      PDF Downloaden
    </button>
  </div>

  <div class="offerte-doc" id="offerte-doc">
    <!-- dynamisch gevuld -->
  </div>
</div>

<script>
const TARIEVEN = {
  sauswerk:   { label: 'Sauswerk',             basisprijs: 12, m2PerUur: 6 },
  lakwerk:    { label: 'Lakwerk',              basisprijs: 18, m2PerUur: 4 },
  behangen:   { label: 'Behangen',             basisprijs: 22, m2PerUur: 3.5 },
  buitenwerk: { label: 'Buitenschilderwerk',   basisprijs: 20, m2PerUur: 4.5 },
};
const ONDERGROND = {
  goed:   { label: 'Goed',   toeslag: 0 },
  matig:  { label: 'Matig',  toeslag: 0.10 },
  slecht: { label: 'Slecht', toeslag: 0.25 },
};
const VERFSOORT = {
  standaard:  { label: 'Standaard',  toeslag: 0 },
  premium:    { label: 'Premium',    toeslag: 0.15 },
  ecologisch: { label: 'Ecologisch', toeslag: 0.20 },
};
const UURTARIEF = 45;
const BTW = 0.21;

let state = { typeWerk: 'sauswerk', ondergrond: 'goed', verfsoort: 'standaard' };
let calc = null;

const offerteNr = `SO-${new Date().getFullYear()}-${String(Math.floor(Math.random()*900)+100)}`;
const vandaag = new Date().toLocaleDateString('nl-NL', {year:'numeric',month:'long',day:'numeric'});
const geldigTot = new Date(Date.now()+30*86400000).toLocaleDateString('nl-NL', {year:'numeric',month:'long',day:'numeric'});

function euro(n) {
  return new Intl.NumberFormat('nl-NL', {style:'currency',currency:'EUR'}).format(n);
}

function selectOpt(btn) {
  const group = btn.dataset.group;
  document.querySelectorAll(`[data-group="${group}"]`).forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  state[group] = btn.dataset.val;
  updateCalc();
}

function updateCalc() {
  const opp = parseFloat(document.getElementById('oppervlakte').value);
  const tw = state.typeWerk;

  if (!opp || opp <= 0) {
    document.getElementById('calc-empty').style.display = 'block';
    document.getElementById('calc-rows').style.display = 'none';
    document.getElementById('offerte-btn').disabled = true;
    document.getElementById('tab-preview').disabled = true;
    document.getElementById('uren-hint').textContent = 'Vul oppervlakte in voor een schatting van de uitvoeringstijd';
    calc = null;
    return;
  }

  const tarief = TARIEVEN[tw];
  const oToeslag = ONDERGROND[state.ondergrond].toeslag;
  const vToeslag = VERFSOORT[state.verfsoort].toeslag;

  const uren = Math.round((opp / tarief.m2PerUur) * 10) / 10;
  const arbeid = uren * UURTARIEF;
  const materiaal = opp * tarief.basisprijs * 0.35;
  const basis = arbeid + materiaal;
  const toeslagen = basis * (oToeslag + vToeslag);
  const subtotaal = basis + toeslagen;
  const btw = subtotaal * BTW;
  const totaal = subtotaal + btw;

  calc = { uren, arbeid, materiaal, toeslagen, subtotaal, btw, totaal, opp, oToeslag, vToeslag };

  document.getElementById('uren-hint').textContent = `Geschatte uitvoeringstijd: ~${uren} uur`;
  document.getElementById('uren-label').textContent = `${uren} uur √ó ‚Ç¨${UURTARIEF}/uur`;
  document.getElementById('mat-label').textContent = `${VERFSOORT[state.verfsoort].label} verf, ${opp} m¬≤`;
  document.getElementById('val-arbeid').textContent = euro(arbeid);
  document.getElementById('val-materiaal').textContent = euro(materiaal);

  if (toeslagen > 0) {
    const parts = [];
    if (oToeslag > 0) parts.push(`Ondergrond +${oToeslag*100}%`);
    if (vToeslag > 0) parts.push(`Verf +${vToeslag*100}%`);
    document.getElementById('toeslag-label').textContent = parts.join(', ');
    document.getElementById('val-toeslag').textContent = euro(toeslagen);
    document.getElementById('toeslag-row').style.display = 'flex';
  } else {
    document.getElementById('toeslag-row').style.display = 'none';
  }

  document.getElementById('val-btw').textContent = euro(btw);
  document.getElementById('val-totaal').textContent = euro(totaal);
  document.getElementById('subtotaal-note').textContent = `Excl. BTW: ${euro(subtotaal)}`;

  document.getElementById('calc-empty').style.display = 'none';
  document.getElementById('calc-rows').style.display = 'block';
  document.getElementById('offerte-btn').disabled = false;
  document.getElementById('tab-preview').disabled = false;
}

function buildOfferte() {
  if (!calc) return;
  const naam = document.getElementById('naam').value || '‚Äî';
  const adres = document.getElementById('adres').value || '‚Äî';
  const email = document.getElementById('email').value || '‚Äî';
  const opp = document.getElementById('oppervlakte').value;
  const tw = TARIEVEN[state.typeWerk];
  const ond = ONDERGROND[state.ondergrond];
  const verf = VERFSOORT[state.verfsoort];

  const rows = [
    { omsch: 'Arbeidskosten', detail: `${calc.uren} uur √ó ‚Ç¨${UURTARIEF}/uur`, val: calc.arbeid },
    { omsch: 'Materiaalkosten', detail: `${verf.label} verf ‚Äî ${opp} m¬≤`, val: calc.materiaal },
    ...(calc.toeslagen > 0 ? [{
      omsch: 'Toeslagen',
      detail: [ond.toeslag > 0 && `Ondergrond (${ond.toeslag*100}%)`, verf.toeslag > 0 && `${verf.label} verf (${verf.toeslag*100}%)`].filter(Boolean).join(', '),
      val: calc.toeslagen
    }] : [])
  ];

  document.getElementById('offerte-doc').innerHTML = `
    <div class="doc-header">
      <div>
        <div class="doc-brand-name">Quot<span>ly</span></div>
        <div class="doc-brand-sub">Offerte Generator ¬∑ Tiel ¬∑ 06-39170400</div>
        <div class="doc-brand-sub" style="margin-top:2px;">quotlynl@gmail.com</div>
      </div>
      <div class="doc-meta">
        <div><strong>Offerte nr:</strong> ${offerteNr}</div>
        <div><strong>Datum:</strong> ${vandaag}</div>
        <div><strong>Geldig tot:</strong> ${geldigTot}</div>
      </div>
    </div>

    <div class="doc-two-col">
      <div>
        <div class="doc-section-label">Klantgegevens</div>
        <div class="doc-info"><strong>${naam}</strong>${adres}<br/>${email}</div>
      </div>
      <div>
        <div class="doc-section-label">Projectdetails</div>
        <div class="doc-info">
          <strong>Type werk</strong>${tw.label}
          <strong style="margin-top:6px;">Oppervlakte</strong>${opp} m¬≤
          <strong style="margin-top:6px;">Geschatte duur</strong>${calc.uren} uur
        </div>
      </div>
    </div>

    <div class="scope-box">
      <div class="doc-section-label">Specificaties</div>
      <div class="scope-grid">
        <div><div class="scope-item-label">Type werk</div><div class="scope-item-val">${tw.label}</div></div>
        <div><div class="scope-item-label">Ondergrond</div><div class="scope-item-val">${ond.label}</div></div>
        <div><div class="scope-item-label">Verfsoort</div><div class="scope-item-val">${verf.label}</div></div>
      </div>
    </div>

    <div class="doc-section-label" style="margin-bottom:14px;">Kostenspecificatie</div>
    <table class="doc-table">
      <thead><tr><th>Omschrijving</th><th>Details</th><th>Bedrag</th></tr></thead>
      <tbody>
        ${rows.map(r => `<tr><td>${r.omsch}</td><td style="color:#7a8fa6;font-size:13px;">${r.detail}</td><td>${euro(r.val)}</td></tr>`).join('')}
      </tbody>
    </table>

    <div class="doc-totals">
      <div class="doc-subtotal-row"><span>Subtotaal excl. BTW</span><span>${euro(calc.subtotaal)}</span></div>
      <div class="doc-btw-row"><span>BTW (21%)</span><span>${euro(calc.btw)}</span></div>
      <div class="doc-total-row"><span class="doc-total-label">Totaal incl. BTW</span><span class="doc-total-val">${euro(calc.totaal)}</span></div>
    </div>

    <div class="doc-voorwaarden">
      <div class="doc-vw-title">Offerte-voorwaarden</div>
      <ul class="doc-vw-list">
        <li>Deze offerte is geldig tot <strong style="color:#3a4e62;">${geldigTot}</strong></li>
        <li>Betalingsconditie: 30% aanbetaling, 70% na oplevering</li>
        <li>Prijs is inclusief arbeidskosten, materialen en BTW</li>
        <li>Eventueel meerwerk wordt vooraf schriftelijk besproken</li>
      </ul>
    </div>

    <div class="doc-footer">
      Aangemaakt met <strong style="color:#2563eb;">Quotly</strong> ‚Äî Professionele offertes voor schildersbedrijven<br/>
      <span>Offerte ${offerteNr} ¬∑ ${vandaag} ¬∑ quotlynl@gmail.com ¬∑ 06-39170400</span>
    </div>
  `;
}

function showSection(section) {
  if (section === 'preview' && !calc) return;
  if (section === 'preview') buildOfferte();
  document.getElementById('form-section').style.display = section === 'form' ? 'block' : 'none';
  document.getElementById('preview-section').style.display = section === 'preview' ? 'block' : 'none';
  document.getElementById('tab-form').classList.toggle('active', section === 'form');
  document.getElementById('tab-preview').classList.toggle('active', section === 'preview');
}
</script>
</body>
</html>
